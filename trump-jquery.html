<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>TRUMP</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,800,700,300' rel='stylesheet' type='text/css'>
    <style media="screen">
      body {
        font-family: 'Open Sans', sans-serif;
        background-color: black;
        color: white;
      }
      .on {
        visibility: visible;
      }
      .off {
        visibility: hidden;
      }
      form input {
        font-size: 1em;
        width: 75px;
        height: 30px;
        border-top-style: none;
        border-right-style: none;
        border-left-style: none;
        background-color: rgba(240, 240, 240, 0.10);
        padding: 10px;
        margin-right: 20px;
        border-radius: 4px;
        text-align: center;
        color: white;
      }
      button {
        font-size: 1em;
        padding: 15px;
        margin-right: 20px;
        border-radius: 4px;
        border-right-style: none;
        border-left-style: none;
        border-bottom-style: none;
        border-top-style: none;
        text-align: center;
        background-color: #009efa;
        color: white;
      }
      :placeholder-shown {
        color: rgba(255, 255, 255, 0.2);
      }
      ::-webkit-input-placeholder { /* Safari, Chrome and Opera */
        color: rgba(255, 255, 255, 0.2);
      }

      :-moz-placeholder { /* Firefox 18- */
        color: rgba(255, 255, 255, 0.2);
      }

      ::-moz-placeholder { /* Firefox 19+ */
        color: rgba(255, 255, 255, 0.2);
      }

      :-ms-input-placeholder { /* IE 10+ */
        color: rgba(255, 255, 255, 0.2);
      }

      ::-ms-input-placeholder { /* Edge */
        color: rgba(255, 255, 255, 0.2);
      }

      :placeholder-shown { /* Standard one last! */
        color: rgba(255, 255, 255, 0.2);
      }
      .breakdown {
        font-size: 1em;
        color: grey;
        float: left;
        font-weight: 400;
      }
      .difference {
        font-size: 1em;
        color: grey;
        font-weight: 800;
      }
      .total {
        text-decoration: none;
        list-style-type: none;
        font-size: 3em;
        font-weight: 800;
      }
      table tbody tr div {
        float: left;
      }
      .winningHand {
        color: green;
      }
      .losingHand {
        color: rgba(204, 0, 0, 1);;
      }

    </style>
  </head>
  <body>
    <div id="namePrompts">

    </div>

    <div>
      <ol id="nameList">
      </ol>
    </div>


    <table id="scoresPrompts">
      <tbody>
        <tr>

        </tr>
      </tbody>
    </table>


    <script type="text/javascript">
      var $players = [];
      var $hand = [{
            cards: [],
            wagers: [],
            scores: [],
            totals: []
      }]
      var $body = $("body");
      var $nameList = $("#nameList");
      var $namePrompts = $("#namePrompts");
      var $scoresPrompts = $("#scoresPrompts");

      // name prompts
      var $nameForm = $("<form>").attr("id", "nameForm").appendTo($namePrompts)
      var $nameField = $("<input>").attr("id", "nameField").attr("placeholder", "Enter Player Name").attr("class", "on").css("width", "192px").appendTo($nameForm);
      var $submitName = $("<button>").attr("id", "submitNameButton").attr("type", "submit").text("Add").appendTo($nameForm);
      var $startGameButton = $("<button>").text("Start Game").attr("id", "startGameButton").appendTo($nameForm)

      // score prompts
      var $scoreForm = $("<form>").attr("id", "scoreForm").appendTo($scoresPrompts).attr("action", "index.html");
      var $wagerField = $("<input>").attr("type", "text").attr("placeholder", "Wager").attr("id", "wager").appendTo($scoreForm).attr("class", "on");
      var $scoreField = $("<input>").attr("type", "text").attr("placeholder", "Score").attr("id", "score").appendTo($scoreForm).attr("class", "on");
      var $button = $("<button>").attr("type", "submit").attr("id", "submitScore").text("Create").appendTo($scoreForm);

      // event listeners
      $("#submitNameButton").on("click", addNameToList);
      $("#submitScore").on("click", calcScore);
      $("#nameForm").on("submit", showScorePrompts);
      $("#startGameButton").on("submit", showScorePrompts);

      // functions
      $scoreForm.hide()
      $startGameButton.hide()

      function addNameToList(event) {
        event.preventDefault();
        var theName = $("#nameField").val()
        var $nameForm = $("form")
        $players.push({
            name: theName
        })
        var $currentItem = $players.length - 1;
        var $newNameOnList = $("<li>").text($players[$currentItem].name).appendTo($nameList)
        $("#nameField").trigger("reset");
        if ($players.length == 2) {
          $startGameButton.show();
        }
        $nameForm.reset();
      }

      function showScorePrompts(event) {
        event.preventDefault();
        $nameList.hide()
        $namePrompts.hide()
        $scoreForm.show()
        $("#startGameButton").hide()

      }

      function calcScore(event) {
        event.preventDefault();
        var $scoreField = parseInt($("#score").val());
        var $wagerField = parseInt($("#wager").val());

        if ($wagerField == $scoreField) {
          postToPage(10 + $scoreField);
        } else if ($wagerField < $scoreField) {
            postToPage($scoreField - $wagerField);
        } else if ($wagerField > $scoreField) {
            postToPage(0);
        } else {
          console.log("something went wrong");
        }
        $scoreField.reset();
        $wagerField.reset();
      }
    function postToPage (total) {
        // objects
        var $scoreTable = $("tr");
        var $scoreTableItem = $("<td>")
        var $scoreTableItemDiv = $("<div>").attr("class", "breakdown");
        // text
        var $scoreBreakdown = $("<span>")
        var $scoreDifference = $("<span>").attr("class", "difference")
        var $scoreTotal = $("<p>").attr("class", "total");
        var $brk = $("<br />");
        // input values
        var $scoreField = parseInt($("#score").val());
        var $wagerField = parseInt($("#wager").val());
        var $lastTd = $("td").last()
        $scoreBreakdown.text($scoreField + "/" + $wagerField).appendTo($scoreTableItemDiv).after("<br />");
        $scoreDifference.text("+" + total).appendTo($scoreTableItemDiv);
        $scoreTableItemDiv.appendTo($scoreTableItem);
        $scoreTableItem.appendTo($scoreTable);
        $scoreTotal.text(total).appendTo($scoreTableItem);


        if (parseInt(total) >= 10) {
          $scoreTableItem.attr("class", "winningHand");
        } else if (parseInt(total) <10) {
          $scoreTableItem.attr("class", "losingHand");
        }
        $scoreField.reset();
        $wagerField.reset();
    }
    </script>
  </body>
</html>
